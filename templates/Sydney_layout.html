{% extends "base.html" %}

{% block title %}Jobs Clock-In Clock-Out{% endblock %}

{% block content %}
<!-- Main content -->
<main class="page-container py-4">
	<div class="container">

		<div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between mb-4">
			<h1 class="h4 m-0" style="width:100%;text-align:center;">Sydney Production System</h1>
		</div>

		<!-- Two-column layout -->
		<div class="row g-4">

			<!-- Left: Staff & Job -->
			<div class="col-lg-4">
				<div class="card shadow-sm h-100">
					<div class="card-header bg-light fw-bold">Staff & Job Selection</div>
					<div class="card-body">

						<div class="card-body d-flex flex-column gap-3">
							<select id="staff-select" class="form-select">
								<option value="">-- Select Staff --</option>
							</select>

							<select id="job-select" class="form-select">
								<option value="">-- Select Job --</option>
							</select>
						</div>

					</div>
				</div>
			</div>

			<!-- Right: Task Tiles -->
			<div class="col-lg-8">
				<div class="card shadow-sm h-100">
					<div class="card-header bg-light fw-bold">Tasks</div>
					<div class="card-body">
						<div class="row g-3" id="task-selection">
							<div class="col-md-3 col-sm-6">
								<div class="task-tile welding" data-task="welding">
									<i class="bi bi-wrench mb-2"></i>
									<div class="task-text">Welding</div>
								</div>
							</div>
							<div class="col-md-3 col-sm-6">
								<div class="task-tile shrinking" data-task="shrinking">
									<i class="bi bi-arrow-repeat mb-2"></i>
									<div class="task-text">Shrinking</div>
								</div>
							</div>
							<div class="col-md-3 col-sm-6">
								<div class="task-tile gluing" data-task="gluing">
									<i class="bi bi-droplet mb-2"></i>
									<div class="task-text">Gluing</div>
								</div>
							</div>
							<div class="col-md-3 col-sm-6">
								<div class="task-tile soldering" data-task="soldering">
									<i class="bi bi-fire mb-2"></i>
									<div class="task-text">Soldering</div>
								</div>
							</div>
							<div class="col-md-3 col-sm-6">
								<div class="task-tile packaging" data-task="packaging">
									<i class="bi bi-box-seam mb-2"></i>
									<div class="task-text">Packaging</div>
								</div>
							</div>
							<div class="col-md-3 col-sm-6">
								<div class="task-tile machineshop" data-task="machineshop">
									<i class="bi bi-gear mb-2"></i>
									<div class="task-text">Machine shop</div>
								</div>
							</div>
							<div class="col-md-3 col-sm-6">
								<div class="task-tile QC" data-task="QC">
									<i class="bi bi-check2-circle mb-2"></i>
									<div class="task-text">QC</div>
								</div>
							</div>
							<div class="col-md-3 col-sm-6">
								<div class="task-tile express" data-task="express">
									<i class="bi bi-lightning mb-2"></i>
									<div class="task-text">Express</div>
								</div>
							</div>
						</div>

					</div>
				</div>
			</div>

		</div>

		<!-- Action buttons -->
		<div class="d-flex flex-wrap gap-3 justify-content-center my-5">
			<button id="start-btn" type="button" class="btn btn-success px-4 py-2 rounded-pill">Start</button>
			<button id="stop-btn" type="button" class="btn btn-danger px-4 py-2 rounded-pill">Stop</button>
			<button id="finish-btn" data-role="admin-only" type="button"
				class="btn btn-warning px-4 py-2 rounded-pill">End Job</button>
			<button id="view-running-jobs-btn" type="button" class="btn btn-primary px-4 py-2 rounded-pill"
				data-bs-toggle="modal" data-bs-target="#taskOptionsModal">View Running Jobs</button>
			<button id="jobs-status-btn" class="btn btn-primary px-4 py-2 rounded-pill">Jobs Status</button>

		</div>

		<div id="message" class="fw-bold text-center mb-3"></div>

		<!-- Running Jobs Table -->
		<div id="running-jobs-section" style="display: none;">
			<h4 id="running-jobs-title">Running Jobs</h4>
			<table id="running-jobs-table" class="table table-bordered table-striped">
				<thead>
					<tr>
						<th>Staff</th>
						<th>Job ID</th>
						<th>Customer</th>
						<th>Drawing No</th>
						<th>Task</th>
						<th>Start Time</th>
					</tr>
				</thead>
				<tbody></tbody>
			</table>
		</div>

		<!-- Records Table -->
		<div class="table-container">
			<table id="records-table" class="table table-bordered table-striped">
				<thead></thead>
				<tbody></tbody>
			</table>
		</div>

		<!-- Pagination -->
		<div id="pagination-controls" class="text-center" style="display:none;">
			<button id="prev-page" class="btn btn-outline-secondary btn-sm">Previous</button>
			<span id="page-info" class="mx-2"></span>
			<button id="next-page" class="btn btn-outline-secondary btn-sm">Next</button>
		</div>

	</div>
</main>



<!-- Modal: Add Staff -->
<div class="modal fade" id="modal-staff">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Add New Staff</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
			</div>
			<div class="modal-body">
				<input type="text" id="new-staff-name" class="form-control" placeholder="Enter Staff Name" />
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary" onclick="addStaff()">Add Staff</button>
			</div>
		</div>
	</div>
</div>

<!-- Task Options Modal -->
<!-- Task Options Modal (Bootstrap style) -->
<div class="modal fade" id="taskOptionsModal" tabindex="-1" aria-hidden="true">
	<div class="modal-dialog modal-lg">
		<div class="modal-content tasks">

			<div class="modal-header">
				<h5 class="modal-title">Select a Task</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>

			<div class="modal-body">
				<div class="row g-3 text-center">

					<div class="col-md-4 col-sm-6">
						<div class="task-tile-option" data-task="welding">
							<img src="/static/Images/welding.png" class="img-fluid rounded mb-2" alt="Welding">
							<div class="fw-bold">Welding</div>
						</div>
					</div>

					<div class="col-md-4 col-sm-6">
						<div class="task-tile-option" data-task="shrinking">
							<img src="/static/Images/shrinking.png" class="img-fluid rounded mb-2" alt="Shrinking">
							<div class="fw-bold">Shrinking</div>
						</div>
					</div>

					<div class="col-md-4 col-sm-6">
						<div class="task-tile-option" data-task="packaging">
							<img src="/static/Images/packaging.png" class="img-fluid rounded mb-2" alt="Packaging">
							<div class="fw-bold">Packaging</div>
						</div>
					</div>

					<div class="col-md-4 col-sm-6">
						<div class="task-tile-option" data-task="soldering">
							<img src="/static/Images/soldering.png" class="img-fluid rounded mb-2" alt="Soldering">
							<div class="fw-bold">Soldering</div>
						</div>
					</div>

					<div class="col-md-4 col-sm-6">
						<div class="task-tile-option" data-task="gluing">
							<img src="/static/Images/gluing.jpg" class="img-fluid rounded mb-2" alt="Gluing">
							<div class="fw-bold">Gluing</div>
						</div>
					</div>

					<div class="col-md-4 col-sm-6">
						<div class="task-tile-option" data-task="machineshop">
							<img src="static/Images/machine.png" class="img-fluid rounded mb-2" alt="Machine Shop">
							<div class="fw-bold">Machine Shop</div>
						</div>
					</div>

					<div class="col-md-4 col-sm-6">
						<div class="task-tile-option" data-task="QC">
							<img src="static/Images/qc.jpg" class="img-fluid rounded mb-2" alt="QC">
							<div class="fw-bold">QC</div>
						</div>
					</div>

					<div class="col-md-4 col-sm-6">
						<div class="task-tile-option" data-task="Express">
							<img src="static/Images/express.jpg" class="img-fluid rounded mb-2" alt="Express">
							<div class="fw-bold">Express</div>
						</div>
					</div>
					<div class="col-md-4 col-sm-6">
						<div class="task-tile-option" data-task="ALL">
							<div class="p-3 border rounded bg-light text-center fw-bold">
								ðŸ“‹ All Tasks
							</div>
						</div>
					</div>


				</div>
			</div>

		</div>
	</div>
</div>


<!-- Modal: Finish Job Result -->
<div class="modal fade" id="finishResultModal" tabindex="-1" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header bg-warning">
				<h5 class="modal-title">Job Finished</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
			</div>
			<div class="modal-body" id="finishResultBody">
				<!-- Filled dynamically -->
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
				<button id="moveJobInModalBtn" type="button" class="btn btn-primary">
					Move to Finished Jobs
				</button>
			</div>




		</div>
	</div>
</div>

<!-- Delete Staff Modal -->
<div class="modal fade" id="deleteStaffModal" tabindex="-1" aria-labelledby="deleteStaffModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header bg-danger text-white">
				<h5 class="modal-title" id="deleteStaffModalLabel">Delete Staff</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<label for="deleteStaffSelect" class="form-label">Select Staff to Delete</label>
				<select id="deleteStaffSelect" class="form-select">
					<option value="">-- Select Staff --</option>
				</select>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-danger" id="confirmDeleteStaffBtn">Delete</button>
			</div>
		</div>
	</div>
</div>

<!-- Delete Job Modal -->
<div class="modal fade" id="deleteJobModal" tabindex="-1" aria-labelledby="deleteJobModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header bg-danger text-white">
				<h5 class="modal-title" id="deleteJobModalLabel">Delete Job</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<label for="deleteJobSelect" class="form-label">Select Job to Delete</label>
				<select id="deleteJobSelect" class="form-select">
					<option value="">-- Select Job --</option>
				</select>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-danger" id="confirmDeleteJobBtn">Delete</button>
			</div>
		</div>
	</div>
</div>

<!-- Edit Time Modal -->
<div class="modal fade" id="editTimeModal" tabindex="-1" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header bg-primary text-white">
				<h5 class="modal-title">Edit Clock Record</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
			</div>
			<div class="modal-body">
				<form id="editTimeForm">
					<input type="hidden" id="editRecordId">

					<div class="mb-3">
						<label class="form-label">Start Time</label>
						<input type="text" class="form-control" id="editStartTime" placeholder="YYYY-MM-DD HH:MM:SS">
					</div>

					<div class="mb-3">
						<label class="form-label">Stop Time</label>
						<input type="text" class="form-control" id="editStopTime" placeholder="YYYY-MM-DD HH:MM:SS">
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" id="saveEditTimeBtn">Save</button>
			</div>
		</div>
	</div>
</div>


<!-- Delete Time Modal -->
<div class="modal fade" id="deleteTimeModal" tabindex="-1" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header bg-danger text-white">
				<h5 class="modal-title">Delete Record</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
			</div>
			<div class="modal-body">
				<p>Are you sure you want to delete this clock record?</p>
				<input type="hidden" id="deleteRecordId">
				<div id="deleteMessage" class="mt-2 fw-bold"></div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-danger" id="confirmDeleteTimeBtn">Delete</button>
			</div>
		</div>
	</div>
</div>

{% endblock %}